import { vec, vAdd, vMul, vLen, vNorm, itrPhysics, totalEnergy, vSub, } from "../../physics";
const DAMPING = 0.5;
const VERTICAL_PUSH_FORCE = 1000;
const HORIZONTAL_PUSH_FORCE = 1000;
const IDEAL_MIN_VERTICAL_DIS = 150;
const IDEAL_MAX_VERTICAL_DIS = 200;
const MIN_HORIZONTAL_DISTANCE = 400;
const MIN_VERTCIAL_DISTANCE_TO_APPLY_HOR_DISTANCE = 80; // only if they are at least 100 pixels close we want to move them apart
const MIN_VERTICAL_DISTANCE_FOR_ALIGNING = 50;
const ALIGNMENT_FORCE = 100;
const MIN_ENERGY = 0.01;
const MAX_SPEED = 100;
const DT_SIZE = 15;
const MIN_DIS_FROM_NODE_I_TO_O = 500;
const entitiesToLayout = (entities) => {
    return entities.reduce((prev, curr) => {
        const topLeft = vSub(curr.p, vec(curr.s.width / 2, curr.s.height / 2));
        return { ...prev, [curr.id]: { p: topLeft, s: curr.s } };
    }, {});
};
export const orderLayout = ({ nodes, edges }, maxItrs, onItr) => {
    let entities = Object.entries(nodes).map(([id, value]) => {
        const center = vAdd(value.p, vec(value.s.width / 2, value.s.height / 2));
        return {
            id,
            p: center,
            f: vec(0, 0),
            v: vec(0, 0),
            m: 1,
            s: value.s,
        };
    });
    let itrs = 0;
    while (itrs < maxItrs && (itrs < 2 || totalEnergy(entities) > MIN_ENERGY)) {
        // eslint-disable-next-line no-loop-func
        let ents = entities;
        for (let i = 0; i < ents.length; i++) {
            for (let j = i + 1; j < ents.length; j++) {
                if (i !== j) {
                    const e1 = ents[i];
                    const e2 = ents[j];
                    if (!e1 || !e2) {
                        continue;
                    }
                    const diff = vSub(e1.p, e2.p);
                    const dx = Math.abs(diff.x);
                    const dy = Math.abs(diff.y);
                    const isE1NodeInput = e1.id.startsWith("node-input");
                    const isE1NodeOutput = e1.id.startsWith("node-output");
                    const isE2NodeInput = e2.id.startsWith("node-input");
                    const isE2NodeOutput = e2.id.startsWith("node-output");
                    // push aside those that are too close horizontally
                    if (dx < MIN_HORIZONTAL_DISTANCE &&
                        dy < MIN_VERTCIAL_DISTANCE_TO_APPLY_HOR_DISTANCE) {
                        const delta = MIN_HORIZONTAL_DISTANCE - dx;
                        const force = delta * HORIZONTAL_PUSH_FORCE;
                        e1.f = vAdd(e1.f, vec(force * 0.5, 0));
                        e2.f = vAdd(e2.f, vec(force * -0.5, 0));
                    }
                    if (dy < MIN_VERTICAL_DISTANCE_FOR_ALIGNING) {
                        const force = diff.y * ALIGNMENT_FORCE;
                        e1.f = vAdd(e1.f, vec(0, force * 0.5));
                        e2.f = vAdd(e2.f, vec(0, force * -0.5));
                    }
                    if (isE1NodeInput && isE2NodeOutput) {
                        // make sure e1 is above e2
                        const delta = vSub(e1.p, e2.p);
                        const dy = delta.y;
                        if (dy < -MIN_DIS_FROM_NODE_I_TO_O) {
                            const mod = MIN_HORIZONTAL_DISTANCE - dy;
                            const force = mod * ALIGNMENT_FORCE;
                            e1.f = vAdd(e1.f, vec(0, force * -0.5));
                            e2.f = vAdd(e2.f, vec(0, force * 0.5));
                        }
                    }
                    else if (isE1NodeOutput && isE2NodeInput) {
                        const delta = vSub(e1.p, e2.p);
                        const dy = delta.y;
                        if (dy < MIN_DIS_FROM_NODE_I_TO_O) {
                            const mod = MIN_HORIZONTAL_DISTANCE - dy;
                            const force = mod * ALIGNMENT_FORCE;
                            e1.f = vAdd(e1.f, vec(0, force * -0.5));
                            e2.f = vAdd(e2.f, vec(0, force * 0.5));
                        }
                    }
                    else if (isE1NodeInput && isE2NodeInput) {
                        // make sure e1 and e2 are aligned horizontal
                    }
                    else if (isE2NodeInput && isE2NodeOutput) {
                        // make sure e1 and e2 are aligned horizontal
                    }
                    // push to middle
                    const midDif = vSub(e1.p, vec(0, e1.p.y));
                    // const midDif2 = vSub(e2.p, vec(0, e.p.y ));
                    const distanceFromMiddle = vLen(midDif);
                    const force = vMul(vNorm(midDif), distanceFromMiddle * -50);
                    e1.f = vAdd(e1.f, force);
                }
            }
        }
        edges.forEach((edge) => {
            let e1 = ents.find((e) => e.id === edge[0]);
            let e2 = ents.find((e) => e.id === edge[1]);
            if (!e1 || !e2) {
                console.warn("weoops", edge[0], edge[1]);
                return;
            }
            const idealDiff = vec(0, -IDEAL_MAX_VERTICAL_DIS);
            const realDiff = vSub(e1.p, e2.p);
            const delta = vSub(idealDiff, realDiff);
            const deltaLen = vLen(delta);
            const forceMagnitude = deltaLen * VERTICAL_PUSH_FORCE;
            // only apply if it's a distancing force, not pushing
            // if (forceMagnitude > 0) {
            const force1 = vMul(vNorm(delta), forceMagnitude * 0.5);
            const force2 = vMul(vNorm(delta), forceMagnitude * -0.5);
            e1.f = vAdd(e1.f, force1);
            e2.f = vAdd(e2.f, force2);
        });
        // make the wheels of neuton turn
        ents = ents.map((ent) => {
            return itrPhysics(DT_SIZE, ent);
        });
        // damp & cap speed
        ents = ents.map((ent) => {
            const damped = vMul(ent.v, DAMPING);
            const vel = vLen(damped) > MAX_SPEED ? vMul(vNorm(damped), MAX_SPEED) : damped;
            return { ...ent, v: vel };
        });
        entities = ents;
        if (onItr) {
            onItr({
                nodes: entitiesToLayout(ents),
                edges,
            }, itrs);
        }
        itrs++;
    }
    return {
        nodes: entitiesToLayout(entities),
        edges,
        itrs,
        timeout: itrs >= maxItrs,
        total: totalEnergy(entities),
    };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvdmlzdWFsLW5vZGUtZWRpdG9yL29yZGVyLWxheW91dC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBR0wsR0FBRyxFQUNILElBQUksRUFDSixJQUFJLEVBQ0osSUFBSSxFQUNKLEtBQUssRUFDTCxVQUFVLEVBQ1YsV0FBVyxFQUNYLElBQUksR0FDTCxNQUFNLGVBQWUsQ0FBQztBQVV2QixNQUFNLE9BQU8sR0FBRyxHQUFHLENBQUM7QUFDcEIsTUFBTSxtQkFBbUIsR0FBRyxJQUFJLENBQUM7QUFDakMsTUFBTSxxQkFBcUIsR0FBRyxJQUFJLENBQUM7QUFFbkMsTUFBTSxzQkFBc0IsR0FBRyxHQUFHLENBQUM7QUFDbkMsTUFBTSxzQkFBc0IsR0FBRyxHQUFHLENBQUM7QUFFbkMsTUFBTSx1QkFBdUIsR0FBRyxHQUFHLENBQUM7QUFDcEMsTUFBTSwyQ0FBMkMsR0FBRyxFQUFFLENBQUMsQ0FBQyx3RUFBd0U7QUFFaEksTUFBTSxrQ0FBa0MsR0FBRyxFQUFFLENBQUM7QUFDOUMsTUFBTSxlQUFlLEdBQUcsR0FBRyxDQUFDO0FBRTVCLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQztBQUN4QixNQUFNLFNBQVMsR0FBRyxHQUFHLENBQUM7QUFDdEIsTUFBTSxPQUFPLEdBQUcsRUFBRSxDQUFDO0FBRW5CLE1BQU0sd0JBQXdCLEdBQUcsR0FBRyxDQUFDO0FBRXJDLE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQyxRQUFrQixFQUFrQixFQUFFO0lBQzlELE9BQU8sUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBRTtRQUNwQyxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxD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